<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ABSI NEXUS PRO - Full Integrated</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --text: #eaecef; --dim: #848e9c; --green: #0ecb81; --red: #f6465d; --yellow: #fcd535; --border: #2b3139; }
        body, html { background: var(--bg); color: var(--text); margin: 0; padding: 0; height: 100vh; overflow: hidden; font-family: sans-serif; font-size: 11px; }
        .page-content { display: none; height: calc(100vh - 65px); overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .page-content.active { display: block; }
        
        .header-main { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; border-bottom: 1px solid var(--border); background: var(--bg); position: sticky; top: 0; z-index: 100; }
        .input-group { background: var(--card); border: 1px solid var(--border); border-radius: 4px; display: flex; align-items: center; padding: 6px 10px; margin-bottom: 8px; }
        .input-group input { background: none; border: none; color: white; width: 100%; text-align: right; outline: none; font-size: 12px; font-weight: bold; }
        .side-btn { flex: 1; padding: 8px; border: none; font-weight: bold; cursor: pointer; border-radius: 4px; }
        
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 65px; background: #161a1e; display: flex; border-top: 1px solid var(--border); z-index: 1000; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--dim); cursor: pointer; }
        .nav-item.active { color: white; }
        .ob-row { display: flex; justify-content: space-between; font-family: monospace; font-size: 10px; margin-bottom: 2px; }
        
        /* ØªØµÙ…ÙŠÙ… Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .services-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; text-align: center; }
        .service-item { cursor: pointer; transition: 0.2s; }
        .service-item:active { transform: scale(0.9); }
        .service-item i { font-size: 20px; margin-bottom: 5px; }
        .service-item span { font-size: 10px; display: block; color: var(--text); }
    </style>
</head>
<body>

<div id="app">

    <div id="home" class="page-content active">
        <div style="padding: 10px 15px; display: flex; align-items: center; gap: 12px;">
            <i class="fas fa-user-circle" style="font-size: 24px; color: var(--dim);"></i>
            <div style="flex: 1; background: var(--card); border-radius: 20px; padding: 6px 12px; display: flex; align-items: center; gap: 8px; color: var(--dim);">
                <i class="fas fa-search" style="font-size: 11px;"></i>
                <span style="font-size: 11px;">BTC ğŸ”¥</span>
            </div>
            <i class="fas fa-headset" style="font-size: 18px; color: var(--dim);"></i>
            <i class="fas fa-bell" style="font-size: 18px; color: var(--dim);"></i>
        </div>

        <div style="padding: 0 15px;">
            <div style="margin: 15px 0; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="display: flex; align-items: center; gap: 5px; color: var(--dim); font-size: 11px;">
                        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ù‚Ø¯Ø± (USDT)</span>
                        <i class="fas fa-eye"></i>
                    </div>
                    <h1 style="margin: 5px 0; font-size: 28px;">0.00</h1>
                </div>
                <button onclick="openHomeOverlay('deposit')" style="background: var(--yellow); border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; font-size: 12px; cursor: pointer;">Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„</button>
            </div>

            <div class="services-grid">
                <div class="service-item" onclick="openHomeOverlay('earn')" style="color:var(--yellow)"><i class="fas fa-coins"></i><span>Earn</span></div>
                <div class="service-item" onclick="openHomeOverlay('referral')" style="color:#4facfe"><i class="fas fa-user-plus"></i><span>Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</span></div>
                <div class="service-item" onclick="page('trade', document.querySelectorAll('.nav-item')[1])" style="color:#f093fb"><i class="fas fa-list-alt"></i><span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></div>
                <div class="service-item" onclick="openHomeOverlay('insights')" style="color:var(--green)"><i class="fas fa-chart-line"></i><span>Ø±Ø¤Ù‰</span></div>
            </div>

            <div style="background: linear-gradient(90deg, #1e2329 0%, #2b3139 100%); border-radius: 12px; padding: 15px; border: 1px solid var(--border); margin-bottom: 20px;">
                <h4 style="margin: 0; font-size: 13px; color: var(--yellow);">Ø¨Ø·Ù„ Ø§Ù„ØªØ¯Ø§ÙˆÙ„</h4>
                <p style="margin: 5px 0; font-size: 10px; color: var(--dim);">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù† ÙˆØ§Ø±Ø¨Ø­ Ø¬ÙˆØ§Ø¦Ø² ÙŠÙˆÙ…ÙŠØ©</p>
                <button onclick="alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„')" style="background: var(--yellow); border: none; padding: 4px 10px; border-radius: 4px; font-size: 10px; font-weight: bold; margin-top: 5px;">Ø³Ø¬Ù„</button>
            </div>

            <div style="display: flex; gap: 10px;">
                <div style="flex: 1; background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid var(--border);">
                    <small style="color:var(--dim)">BNB</small>
                    <div style="font-size: 16px; font-weight: bold; margin-top:5px;">855.61</div>
                    <div style="color: var(--green); font-size: 10px;">+3.25%</div>
                </div>
                <div style="flex: 1; background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid var(--border);">
                    <small style="color:var(--dim)">SOL</small>
                    <div style="font-size: 16px; font-weight: bold; margin-top:5px;">126.80</div>
                    <div style="color: var(--green); font-size: 10px;">+6.30%</div>
                </div>
            </div>
        </div>

        <div id="homeOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; padding:20px; box-sizing:border-box;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2 id="overlayTitle" style="margin:0; font-size:18px;"></h2>
                <i class="fas fa-times" onclick="closeHomeOverlay()" style="font-size:20px; color:var(--dim);"></i>
            </div>
            <div id="overlayBody"></div>
        </div>
    </div>

    <div id="trade" class="page-content">
    <div style="padding: 10px 15px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 12px; background: var(--bg); position: sticky; top: 0; z-index: 100;">
        <div onclick="toggleSpotMarkets()" style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <i class="fas fa-bars" style="font-size: 14px; color: var(--dim);"></i>
            <strong id="spotPair" style="font-size:16px;">BTC/USDT</strong>
        </div>
        <span id="spotChange" style="font-size:11px; color:var(--green);">+3.25%</span>
        <div style="margin-right: auto; display: flex; gap: 15px; color: var(--dim);">
            <i class="fas fa-chart-line" onclick="alert('ÙØªØ­ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ')"></i>
            <i class="fas fa-ellipsis-v"></i>
        </div>
    </div>

    <div id="spotMarketList" style="display:none; position:absolute; top:45px; left:0; width:100%; background:var(--card); z-index:1000; border-bottom:1px solid var(--border); max-height:250px; overflow-y:auto; box-shadow: 0 10px 20px rgba(0,0,0,0.5);">
        <div onclick="selectSpotPair('BTC/USDT', 98450)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>BTC/USDT</span><span style="color:var(--green)">98,450</span></div>
        <div onclick="selectSpotPair('ETH/USDT', 3250)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>ETH/USDT</span><span style="color:var(--red)">3,250.2</span></div>
        <div onclick="selectSpotPair('SOL/USDT', 128)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>SOL/USDT</span><span style="color:var(--green)">128.4</span></div>
    </div>

    <div style="display:flex; padding:12px; gap:15px;">
        <div style="flex:1.2;">
            <div style="display:flex; background:var(--card); border-radius:4px; margin-bottom:12px; overflow:hidden; border:1px solid var(--border);">
                <button id="btnSpotBuy" onclick="setSpotSide('buy')" style="flex:1; padding:8px; border:none; background:var(--green); color:white; font-weight:bold;">Ø´Ø±Ø§Ø¡</button>
                <button id="btnSpotSell" onclick="setSpotSide('sell')" style="flex:1; padding:8px; border:none; background:none; color:var(--dim); font-weight:bold;">Ø¨ÙŠØ¹</button>
            </div>

            <select id="orderType" style="width:100%; background:var(--card); color:var(--text); border:1px solid var(--border); padding:5px; border-radius:4px; margin-bottom:10px; font-size:11px;">
                <option value="limit">Limit (Ø­Ø¯)</option>
                <option value="market">Market (Ø³ÙˆÙ‚)</option>
                <option value="stop">Stop-Limit</option>
            </select>

            <div style="font-size:10px; color:var(--dim); margin-bottom:5px; display:flex; justify-content:space-between;">
                <span>Ù…ØªØ§Ø­</span>
                <span><span id="spotAvail">15,000.00</span> <span id="availUnit">USDT</span></span>
            </div>

            <div class="input-group" id="priceRow">
                <span style="color:var(--dim); font-size:10px;">Ø§Ù„Ø³Ø¹Ø±</span>
                <input type="number" id="spotPrice" value="98450.00">
                <span style="font-size:10px;">USDT</span>
            </div>

            <div class="input-group">
                <span style="color:var(--dim); font-size:10px;">Ø§Ù„ÙƒÙ…ÙŠØ©</span>
                <input type="number" id="spotQty" placeholder="0.00" oninput="calcSpotTotal()">
                <span style="font-size:10px;" id="qtyUnit">BTC</span>
            </div>

            <div style="display:flex; justify-content:space-between; margin:10px 0;">
                <button onclick="setPercent(25)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">25%</button>
                <button onclick="setPercent(50)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">50%</button>
                <button onclick="setPercent(75)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">75%</button>
                <button onclick="setPercent(100)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">100%</button>
            </div>

            <div style="font-size:11px; margin-bottom:12px; display:flex; justify-content:space-between;">
                <span style="color:var(--dim);">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                <span><span id="spotTotal">0.00</span> USDT</span>
            </div>

            <button id="spotMainBtn" onclick="executeSpotTrade()" style="width:100%; padding:12px; background:var(--green); color:white; border:none; border-radius:4px; font-weight:bold; font-size:14px;">Ø´Ø±Ø§Ø¡ BTC</button>
        </div>

        <div style="flex:0.8; font-family: monospace; font-size: 10px;">
            <div id="spotRedOB" style="height: 120px; overflow:hidden; display:flex; flex-direction:column-reverse; color:var(--red); opacity:0.9;"></div>
            <div style="margin:8px 0; text-align:center;">
                <div id="spotMidPrice" style="font-size:15px; font-weight:bold; color:var(--green);">98,450.00</div>
                <div style="font-size:9px; color:var(--dim);">$98,450.00</div>
            </div>
            <div id="spotGreenOB" style="height: 120px; overflow:hidden; color:var(--green); opacity:0.9;"></div>
        </div>
    </div>

    <div style="border-top:5px solid #161a1e; margin-top:10px;">
        <div style="display:flex; border-bottom:1px solid var(--border); font-size:12px;">
            <div style="padding:10px 15px; border-bottom:2px solid var(--yellow); color:var(--text);">Ø·Ù„Ø¨Ø§Øª Ù…ÙØªÙˆØ­Ø© (0)</div>
            <div style="padding:10px 15px; color:var(--dim);">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¯Ø§ÙˆÙ„</div>
        </div>
        <div id="spotOrdersList" style="padding:20px; text-align:center; color:var(--dim); font-size:11px;">
            <i class="fas fa-file-invoice" style="font-size:24px; opacity:0.1; display:block; margin-bottom:10px;"></i>
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ÙØªÙˆØ­Ø©
        </div>
    </div>
</div>

<script>
    // --- Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„ÙÙˆØ±ÙŠ (Spot Engine) ---
    let spotSide = 'buy';
    let spotUsdtBalance = 15000.00;
    let spotCoinBalance = 0.00;
    let currentSpotPrice = 98450.00;

    function liveSpotData() {
        currentSpotPrice += (Math.random() - 0.5) * 10;
        const midPrice = document.getElementById('spotMidPrice');
        if(!midPrice) return;
        midPrice.innerText = currentSpotPrice.toFixed(2);
        midPrice.style.color = Math.random() > 0.5 ? 'var(--green)' : 'var(--red)';

        // ØªØ­Ø¯ÙŠØ« Ø¯ÙØªØ± Ø§Ù„Ø£ÙˆØ§Ù…Ø±
        let redH = '', greenH = '';
        for(let i=1; i<=8; i++) {
            redH += `<div style="display:flex; justify-content:space-between;"><span>${(currentSpotPrice + i*2).toFixed(1)}</span><span>${(Math.random()*0.4).toFixed(3)}</span></div>`;
            greenH += `<div style="display:flex; justify-content:space-between;"><span>${(currentSpotPrice - i*2).toFixed(1)}</span><span>${(Math.random()*0.4).toFixed(3)}</span></div>`;
        }
        document.getElementById('spotRedOB').innerHTML = redH;
        document.getElementById('spotGreenOB').innerHTML = greenH;
    }
    setInterval(liveSpotData, 700);

    function setSpotSide(side) {
        spotSide = side;
        const btn = document.getElementById('spotMainBtn');
        const buyBtn = document.getElementById('btnSpotBuy');
        const sellBtn = document.getElementById('btnSpotSell');
        const unit = document.getElementById('availUnit');
        
        if(side === 'buy') {
            buyBtn.style.background = 'var(--green)'; buyBtn.style.color = 'white';
            sellBtn.style.background = 'none'; sellBtn.style.color = 'var(--dim)';
            btn.style.background = 'var(--green)';
            btn.innerText = `Ø´Ø±Ø§Ø¡ ${document.getElementById('qtyUnit').innerText}`;
            document.getElementById('spotAvail').innerText = spotUsdtBalance.toFixed(2);
            unit.innerText = 'USDT';
        } else {
            sellBtn.style.background = 'var(--red)'; sellBtn.style.color = 'white';
            buyBtn.style.background = 'none'; buyBtn.style.color = 'var(--dim)';
            btn.style.background = 'var(--red)';
            btn.innerText = `Ø¨ÙŠØ¹ ${document.getElementById('qtyUnit').innerText}`;
            document.getElementById('spotAvail').innerText = spotCoinBalance.toFixed(4);
            unit.innerText = document.getElementById('qtyUnit').innerText;
        }
    }

    function calcSpotTotal() {
        const qty = document.getElementById('spotQty').value || 0;
        const price = document.getElementById('spotPrice').value || currentSpotPrice;
        document.getElementById('spotTotal').innerText = (qty * price).toFixed(2);
    }

    function setPercent(p) {
        if(spotSide === 'buy') {
            const amountToUse = spotUsdtBalance * (p/100);
            document.getElementById('spotQty').value = (amountToUse / currentSpotPrice).toFixed(5);
        } else {
            document.getElementById('spotQty').value = (spotCoinBalance * (p/100)).toFixed(5);
        }
        calcSpotTotal();
    }

    function executeSpotTrade() {
        const total = parseFloat(document.getElementById('spotTotal').innerText);
        const qty = parseFloat(document.getElementById('spotQty').value);
        
        if(spotSide === 'buy') {
            if(total > spotUsdtBalance || total <= 0) { alert("Ø±ØµÙŠØ¯ USDT ØºÙŠØ± ÙƒØ§ÙÙ!"); return; }
            spotUsdtBalance -= total;
            spotCoinBalance += qty;
            alert(`ØªÙ… Ø´Ø±Ø§Ø¡ ${qty} Ø¨Ù†Ø¬Ø§Ø­!`);
        } else {
            if(qty > spotCoinBalance || qty <= 0) { alert("Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„Ø© ØºÙŠØ± ÙƒØ§ÙÙ!"); return; }
            spotUsdtBalance += total;
            spotCoinBalance -= qty;
            alert(`ØªÙ… Ø¨ÙŠØ¹ ${qty} Ø¨Ù†Ø¬Ø§Ø­!`);
        }
        setSpotSide(spotSide); // Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­
    }

    function toggleSpotMarkets() {
        const list = document.getElementById('spotMarketList');
        list.style.display = list.style.display === 'none' ? 'block' : 'none';
    }

    function selectSpotPair(pair, price) {
        document.getElementById('spotPair').innerText = pair;
        document.getElementById('qtyUnit').innerText = pair.split('/')[0];
        currentSpotPrice = price;
        document.getElementById('spotPrice').value = price;
        setSpotSide(spotSide);
        toggleSpotMarkets();
    }
</script>

    <div id="futures" class="page-content">
    <div style="background: var(--bg); padding: 8px 15px; border-bottom: 1px solid var(--border); display: flex; gap: 15px; align-items: center; position: sticky; top: 0; z-index: 10;">
        <div onclick="toggleMarketList()" style="cursor:pointer; display:flex; align-items:center; gap:5px; background: var(--card); padding: 4px 8px; border-radius: 4px;">
            <strong id="currentPair" style="font-size:14px;">BTCUSDT</strong>
            <i class="fas fa-caret-down" style="color:var(--dim); font-size: 10px;"></i>
        </div>
        <div style="display:flex; flex-direction:column;">
            <span style="color:var(--green); font-weight:bold; font-size:12px;" id="livePriceTop">98,420.50</span>
            <span style="font-size:9px; color:var(--dim)">0.0100% | 04:12:05</span>
        </div>
        <i class="fas fa-chart-line" style="margin-right: auto; color: var(--dim);"></i>
    </div>

    <div id="marketList" style="display:none; position:absolute; top:45px; left:0; width:100%; background:var(--card); z-index:100; border-bottom:1px solid var(--border); box-shadow: 0 5px 15px rgba(0,0,0,0.5);">
        <div class="market-item" onclick="selectPair('BTCUSDT', 98420)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>BTCUSDT</span><span style="color:var(--green)">98,420</span></div>
        <div class="market-item" onclick="selectPair('ETHUSDT', 3240)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>ETHUSDT</span><span style="color:var(--red)">3,240.5</span></div>
        <div class="market-item" onclick="selectPair('SOLUSDT', 126)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>SOLUSDT</span><span style="color:var(--green)">126.8</span></div>
        <div class="market-item" onclick="selectPair('XRPUSDT', 2.50)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>XRPUSDT</span><span style="color:var(--green)">2.501</span></div>
    </div>

    <div style="display:flex; padding:10px; gap:10px;">
        <div style="flex:0.7; font-family: monospace; font-size: 10px;">
            <div id="obRed" style="height: 120px; overflow:hidden; display:flex; flex-direction:column-reverse; color:var(--red);"></div>
            <div id="obMid" style="font-size:14px; font-weight:bold; margin:8px 0; text-align:center;">98,420</div>
            <div id="obGreen" style="height: 120px; overflow:hidden; color:var(--green);"></div>
        </div>

        <div style="flex:1.3;">
            <div style="display:flex; gap:4px; margin-bottom:8px;">
                <button onclick="this.innerText=(this.innerText=='Ù…ØªÙ‚Ø§Ø·Ø¹'?'Ù…Ø¹Ø²ÙˆÙ„':'Ù…ØªÙ‚Ø§Ø·Ø¹')" style="flex:1; background:var(--card); color:white; border:1px solid var(--border); padding:5px; border-radius:3px; font-size:10px;">Ù…ØªÙ‚Ø§Ø·Ø¹</button>
                <button onclick="changeLev()" style="flex:1; background:var(--card); color:white; border:1px solid var(--border); padding:5px; border-radius:3px; font-size:10px;"><span id="levTxt">20x</span></button>
            </div>

            <div style="display:flex; background:var(--card); border-radius:4px; margin-bottom:8px; border:1px solid var(--border); overflow:hidden;">
                <button id="modeBuy" onclick="setOpMode('buy')" style="flex:1; padding:8px; border:none; background:var(--green); color:white; font-weight:bold;">Ø´Ø±Ø§Ø¡</button>
                <button id="modeSell" onclick="setOpMode('sell')" style="flex:1; padding:8px; border:none; background:none; color:var(--dim); font-weight:bold;">Ø¨ÙŠØ¹</button>
            </div>

            <div style="font-size:10px; margin-bottom:5px; display:flex; justify-content:space-between;">
                <span style="color:var(--dim)">Ù…ØªØ§Ø­</span>
                <span><span id="futBal">10,000.00</span> USDT</span>
            </div>

            <div class="input-group"><input type="number" id="fPrice" value="98420.50"></div>
            <div class="input-group"><input type="number" id="fQty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" oninput="updCost()"></div>

            <input type="range" id="fRange" min="0" max="100" value="0" style="width:100%; margin:10px 0;" oninput="updByPerc(this.value)">

            <div style="display:flex; justify-content:space-between; font-size:10px; margin-bottom:10px;">
                <span style="color:var(--dim)">Ø§Ù„ØªÙƒÙ„ÙØ©</span>
                <span><span id="fCost">0.00</span> USDT</span>
            </div>

            <button id="mainBtn" onclick="placeOrder()" style="width:100%; padding:12px; background:var(--green); color:white; border:none; border-radius:4px; font-weight:bold;">Ø´Ø±Ø§Ø¡ / Long</button>
        </div>
    </div>

    <div style="border-top:5px solid #161a1e; margin-top:10px;">
        <div style="display:flex; border-bottom:1px solid var(--border); font-size:12px;">
            <div style="padding:10px 15px; border-bottom:2px solid var(--yellow); color:var(--text);">Ø§Ù„ØµÙÙ‚Ø§Øª (<span id="posCount">0</span>)</div>
            <div style="padding:10px 15px; color:var(--dim);">Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ÙØªÙˆØ­Ø© (0)</div>
        </div>
        
        <div id="positionsList" style="padding:10px;">
            <div id="emptyMsg" style="text-align:center; padding:30px; color:var(--dim); font-size:11px;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª Ù…ÙØªÙˆØ­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>
        </div>
    </div>
</div>

<script>
    // --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… ---
    let futBalance = 10000.00;
    let futPrice = 98420.50;
    let opMode = 'buy'; 
    let activePositions = [];

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©
    function liveUpdate() {
        futPrice += (Math.random() - 0.5) * 5;
        document.getElementById('livePriceTop').innerText = futPrice.toFixed(2);
        document.getElementById('obMid').innerText = futPrice.toFixed(1);
        document.getElementById('obMid').style.color = Math.random() > 0.5 ? 'var(--green)' : 'var(--red)';

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙ‚Ø§Øª (Ø§Ù„Ø±Ø¨Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø©)
        activePositions.forEach((pos, index) => {
            let diff = futPrice - pos.entry;
            if(pos.type === 'sell') diff = pos.entry - futPrice;
            let pnl = (diff * pos.qty).toFixed(2);
            let roe = ((pnl / pos.margin) * 100).toFixed(2);
            
            document.getElementById(`pnl-${index}`).innerText = (pnl > 0 ? '+' : '') + pnl;
            document.getElementById(`pnl-${index}`).style.color = pnl >= 0 ? 'var(--green)' : 'var(--red)';
            document.getElementById(`roe-${index}`).innerText = roe + "%";
        });

        // Ø¯ÙØªØ± Ø£ÙˆØ§Ù…Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        let rH = '', gH = '';
        for(let i=0; i<6; i++) {
            rH += `<div style="display:flex; justify-content:space-between;"><span>${(futPrice + i).toFixed(1)}</span><span>${(Math.random()*0.5).toFixed(3)}</span></div>`;
            gH += `<div style="display:flex; justify-content:space-between;"><span>${(futPrice - i).toFixed(1)}</span><span>${(Math.random()*0.5).toFixed(3)}</span></div>`;
        }
        document.getElementById('obRed').innerHTML = rH;
        document.getElementById('obGreen').innerHTML = gH;
    }
    setInterval(liveUpdate, 800);

    function setOpMode(m) {
        opMode = m;
        const btn = document.getElementById('mainBtn');
        document.getElementById('modeBuy').style.background = m === 'buy' ? 'var(--green)' : 'none';
        document.getElementById('modeBuy').style.color = m === 'buy' ? 'white' : 'var(--dim)';
        document.getElementById('modeSell').style.background = m === 'sell' ? 'var(--red)' : 'none';
        document.getElementById('modeSell').style.color = m === 'sell' ? 'white' : 'var(--dim)';
        
        btn.style.background = m === 'buy' ? 'var(--green)' : 'var(--red)';
        btn.innerText = m === 'buy' ? 'Ø´Ø±Ø§Ø¡ / Long' : 'Ø¨ÙŠØ¹ / Short';
    }

    function toggleMarketList() {
        const list = document.getElementById('marketList');
        list.style.display = list.style.display === 'none' ? 'block' : 'none';
    }

    function selectPair(pair, price) {
        document.getElementById('currentPair').innerText = pair;
        futPrice = price;
        document.getElementById('fPrice').value = price;
        toggleMarketList();
    }

    function updCost() {
        let q = document.getElementById('fQty').value || 0;
        let l = parseInt(document.getElementById('levTxt').innerText);
        let cost = (q * futPrice) / l;
        document.getElementById('fCost').innerText = cost.toFixed(2);
    }

    function placeOrder() {
        let cost = parseFloat(document.getElementById('fCost').innerText);
        let qty = parseFloat(document.getElementById('fQty').value);
        if(cost <= 0 || cost > futBalance) { alert("Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ!"); return; }

        futBalance -= cost;
        document.getElementById('futBal').innerText = futBalance.toFixed(2);

        let newPos = {
            pair: document.getElementById('currentPair').innerText,
            type: opMode,
            entry: futPrice,
            qty: qty,
            margin: cost,
            lev: document.getElementById('levTxt').innerText
        };
        activePositions.push(newPos);
        renderPositions();
    }

    function renderPositions() {
        const container = document.getElementById('positionsList');
        document.getElementById('posCount').innerText = activePositions.length;
        if(activePositions.length === 0) {
            container.innerHTML = '<div style="text-align:center; padding:30px; color:var(--dim); font-size:11px;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª Ù…ÙØªÙˆØ­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
            return;
        }
        
        container.innerHTML = activePositions.map((p, i) => `
            <div style="background:var(--card); padding:10px; border-radius:4px; margin-bottom:10px; border-left: 4px solid ${p.type=='buy'?'var(--green)':'var(--red)'}">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <strong>${p.pair} <span style="font-size:10px; color:var(--dim)">${p.lev}</span></strong>
                    <button onclick="closePos(${i})" style="background:none; border:1px solid var(--dim); color:var(--dim); font-size:10px; padding:2px 6px; border-radius:2px;">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; font-size:11px;">
                    <div>PNL (USDT): <span id="pnl-${i}" style="font-weight:bold;">0.00</span></div>
                    <div>ROE: <span id="roe-${i}" style="color:var(--green)">0%</span></div>
                    <div style="color:var(--dim)">Ø§Ù„Ø¯Ø®ÙˆÙ„: ${p.entry.toFixed(2)}</div>
                    <div style="color:var(--dim)">Ø§Ù„Ø­Ø¬Ù…: ${(p.qty * p.entry).toFixed(2)}</div>
                </div>
            </div>
        `).join('');
    }

    function closePos(i) {
        futBalance += activePositions[i].margin; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‡Ø§Ù…Ø´ (ØªØ¨Ø³ÙŠØ·)
        document.getElementById('futBal').innerText = futBalance.toFixed(2);
        activePositions.splice(i, 1);
        renderPositions();
    }

    function changeLev() {
        let l = prompt("Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©:", "20");
        if(l) document.getElementById('levTxt').innerText = l + "x";
    }
</script>
    
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ABSI NEXUS PRO - Full Integrated</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --text: #eaecef; --dim: #848e9c; --green: #0ecb81; --red: #f6465d; --yellow: #fcd535; --border: #2b3139; }
        body, html { background: var(--bg); color: var(--text); margin: 0; padding: 0; height: 100vh; overflow: hidden; font-family: sans-serif; font-size: 11px; }
        .page-content { display: none; height: calc(100vh - 65px); overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .page-content.active { display: block; }
        
        .header-main { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; border-bottom: 1px solid var(--border); background: var(--bg); position: sticky; top: 0; z-index: 100; }
        .input-group { background: var(--card); border: 1px solid var(--border); border-radius: 4px; display: flex; align-items: center; padding: 6px 10px; margin-bottom: 8px; }
        .input-group input { background: none; border: none; color: white; width: 100%; text-align: right; outline: none; font-size: 12px; font-weight: bold; }
        .side-btn { flex: 1; padding: 8px; border: none; font-weight: bold; cursor: pointer; border-radius: 4px; }
        
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 65px; background: #161a1e; display: flex; border-top: 1px solid var(--border); z-index: 1000; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--dim); cursor: pointer; }
        .nav-item.active { color: white; }
        .ob-row { display: flex; justify-content: space-between; font-family: monospace; font-size: 10px; margin-bottom: 2px; }
        
        /* ØªØµÙ…ÙŠÙ… Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .services-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; text-align: center; }
        .service-item { cursor: pointer; transition: 0.2s; }
        .service-item:active { transform: scale(0.9); }
        .service-item i { font-size: 20px; margin-bottom: 5px; }
        .service-item span { font-size: 10px; display: block; color: var(--text); }
    </style>
</head>
<body>

<div id="app">

    <div id="home" class="page-content active">
        <div style="padding: 10px 15px; display: flex; align-items: center; gap: 12px;">
            <i class="fas fa-user-circle" style="font-size: 24px; color: var(--dim);"></i>
            <div style="flex: 1; background: var(--card); border-radius: 20px; padding: 6px 12px; display: flex; align-items: center; gap: 8px; color: var(--dim);">
                <i class="fas fa-search" style="font-size: 11px;"></i>
                <span style="font-size: 11px;">BTC ğŸ”¥</span>
            </div>
            <i class="fas fa-headset" style="font-size: 18px; color: var(--dim);"></i>
            <i class="fas fa-bell" style="font-size: 18px; color: var(--dim);"></i>
        </div>

        <div style="padding: 0 15px;">
            <div style="margin: 15px 0; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="display: flex; align-items: center; gap: 5px; color: var(--dim); font-size: 11px;">
                        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ù‚Ø¯Ø± (USDT)</span>
                        <i class="fas fa-eye"></i>
                    </div>
                    <h1 style="margin: 5px 0; font-size: 28px;">0.00</h1>
                </div>
                <button onclick="openHomeOverlay('deposit')" style="background: var(--yellow); border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; font-size: 12px; cursor: pointer;">Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„</button>
            </div>

            <div class="services-grid">
                <div class="service-item" onclick="openHomeOverlay('earn')" style="color:var(--yellow)"><i class="fas fa-coins"></i><span>Earn</span></div>
                <div class="service-item" onclick="openHomeOverlay('referral')" style="color:#4facfe"><i class="fas fa-user-plus"></i><span>Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</span></div>
                <div class="service-item" onclick="page('trade', document.querySelectorAll('.nav-item')[1])" style="color:#f093fb"><i class="fas fa-list-alt"></i><span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></div>
                <div class="service-item" onclick="openHomeOverlay('insights')" style="color:var(--green)"><i class="fas fa-chart-line"></i><span>Ø±Ø¤Ù‰</span></div>
            </div>

            <div style="background: linear-gradient(90deg, #1e2329 0%, #2b3139 100%); border-radius: 12px; padding: 15px; border: 1px solid var(--border); margin-bottom: 20px;">
                <h4 style="margin: 0; font-size: 13px; color: var(--yellow);">Ø¨Ø·Ù„ Ø§Ù„ØªØ¯Ø§ÙˆÙ„</h4>
                <p style="margin: 5px 0; font-size: 10px; color: var(--dim);">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù† ÙˆØ§Ø±Ø¨Ø­ Ø¬ÙˆØ§Ø¦Ø² ÙŠÙˆÙ…ÙŠØ©</p>
                <button onclick="alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„')" style="background: var(--yellow); border: none; padding: 4px 10px; border-radius: 4px; font-size: 10px; font-weight: bold; margin-top: 5px;">Ø³Ø¬Ù„</button>
            </div>

            <div style="display: flex; gap: 10px;">
                <div style="flex: 1; background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid var(--border);">
                    <small style="color:var(--dim)">BNB</small>
                    <div style="font-size: 16px; font-weight: bold; margin-top:5px;">855.61</div>
                    <div style="color: var(--green); font-size: 10px;">+3.25%</div>
                </div>
                <div style="flex: 1; background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid var(--border);">
                    <small style="color:var(--dim)">SOL</small>
                    <div style="font-size: 16px; font-weight: bold; margin-top:5px;">126.80</div>
                    <div style="color: var(--green); font-size: 10px;">+6.30%</div>
                </div>
            </div>
        </div>

        <div id="homeOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; padding:20px; box-sizing:border-box;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2 id="overlayTitle" style="margin:0; font-size:18px;"></h2>
                <i class="fas fa-times" onclick="closeHomeOverlay()" style="font-size:20px; color:var(--dim);"></i>
            </div>
            <div id="overlayBody"></div>
        </div>
    </div>

    <div id="trade" class="page-content">
    <div style="padding: 10px 15px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 12px; background: var(--bg); position: sticky; top: 0; z-index: 100;">
        <div onclick="toggleSpotMarkets()" style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <i class="fas fa-bars" style="font-size: 14px; color: var(--dim);"></i>
            <strong id="spotPair" style="font-size:16px;">BTC/USDT</strong>
        </div>
        <span id="spotChange" style="font-size:11px; color:var(--green);">+3.25%</span>
        <div style="margin-right: auto; display: flex; gap: 15px; color: var(--dim);">
            <i class="fas fa-chart-line" onclick="alert('ÙØªØ­ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ')"></i>
            <i class="fas fa-ellipsis-v"></i>
        </div>
    </div>

    <div id="spotMarketList" style="display:none; position:absolute; top:45px; left:0; width:100%; background:var(--card); z-index:1000; border-bottom:1px solid var(--border); max-height:250px; overflow-y:auto; box-shadow: 0 10px 20px rgba(0,0,0,0.5);">
        <div onclick="selectSpotPair('BTC/USDT', 98450)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>BTC/USDT</span><span style="color:var(--green)">98,450</span></div>
        <div onclick="selectSpotPair('ETH/USDT', 3250)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>ETH/USDT</span><span style="color:var(--red)">3,250.2</span></div>
        <div onclick="selectSpotPair('SOL/USDT', 128)" style="padding:15px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;"><span>SOL/USDT</span><span style="color:var(--green)">128.4</span></div>
    </div>

    <div style="display:flex; padding:12px; gap:15px;">
        <div style="flex:1.2;">
            <div style="display:flex; background:var(--card); border-radius:4px; margin-bottom:12px; overflow:hidden; border:1px solid var(--border);">
                <button id="btnSpotBuy" onclick="setSpotSide('buy')" style="flex:1; padding:8px; border:none; background:var(--green); color:white; font-weight:bold;">Ø´Ø±Ø§Ø¡</button>
                <button id="btnSpotSell" onclick="setSpotSide('sell')" style="flex:1; padding:8px; border:none; background:none; color:var(--dim); font-weight:bold;">Ø¨ÙŠØ¹</button>
            </div>

            <select id="orderType" style="width:100%; background:var(--card); color:var(--text); border:1px solid var(--border); padding:5px; border-radius:4px; margin-bottom:10px; font-size:11px;">
                <option value="limit">Limit (Ø­Ø¯)</option>
                <option value="market">Market (Ø³ÙˆÙ‚)</option>
                <option value="stop">Stop-Limit</option>
            </select>

            <div style="font-size:10px; color:var(--dim); margin-bottom:5px; display:flex; justify-content:space-between;">
                <span>Ù…ØªØ§Ø­</span>
                <span><span id="spotAvail">15,000.00</span> <span id="availUnit">USDT</span></span>
            </div>

            <div class="input-group" id="priceRow">
                <span style="color:var(--dim); font-size:10px;">Ø§Ù„Ø³Ø¹Ø±</span>
                <input type="number" id="spotPrice" value="98450.00">
                <span style="font-size:10px;">USDT</span>
            </div>

            <div class="input-group">
                <span style="color:var(--dim); font-size:10px;">Ø§Ù„ÙƒÙ…ÙŠØ©</span>
                <input type="number" id="spotQty" placeholder="0.00" oninput="calcSpotTotal()">
                <span style="font-size:10px;" id="qtyUnit">BTC</span>
            </div>

            <div style="display:flex; justify-content:space-between; margin:10px 0;">
                <button onclick="setPercent(25)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">25%</button>
                <button onclick="setPercent(50)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">50%</button>
                <button onclick="setPercent(75)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">75%</button>
                <button onclick="setPercent(100)" style="flex:1; background:var(--card); border:1px solid var(--border); color:var(--text); font-size:9px; margin:2px; border-radius:2px; padding:3px;">100%</button>
            </div>

            <div style="font-size:11px; margin-bottom:12px; display:flex; justify-content:space-between;">
                <span style="color:var(--dim);">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                <span><span id="spotTotal">0.00</span> USDT</span>
            </div>

            <button id="spotMainBtn" onclick="executeSpotTrade()" style="width:100%; padding:12px; background:var(--green); color:white; border:none; border-radius:4px; font-weight:bold; font-size:14px;">Ø´Ø±Ø§Ø¡ BTC</button>
        </div>

        <div style="flex:0.8; font-family: monospace; font-size: 10px;">
            <div id="spotRedOB" style="height: 120px; overflow:hidden; display:flex; flex-direction:column-reverse; color:var(--red); opacity:0.9;"></div>
            <div style="margin:8px 0; text-align:center;">
                <div id="spotMidPrice" style="font-size:15px; font-weight:bold; color:var(--green);">98,450.00</div>
                <div style="font-size:9px; color:var(--dim);">$98,450.00</div>
            </div>
            <div id="spotGreenOB" style="height: 120px; overflow:hidden; color:var(--green); opacity:0.9;"></div>
        </div>
    </div>

    <div style="border-top:5px solid #161a1e; margin-top:10px;">
        <div style="display:flex; border-bottom:1px solid var(--border); font-size:12px;">
            <div style="padding:10px 15px; border-bottom:2px solid var(--yellow); color:var(--text);">Ø·Ù„Ø¨Ø§Øª Ù…ÙØªÙˆØ­Ø© (0)</div>
            <div style="padding:10px 15px; color:var(--dim);">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¯Ø§ÙˆÙ„</div>
        </div>
        <div id="spotOrdersList" style="padding:20px; text-align:center; color:var(--dim); font-size:11px;">
            <i class="fas fa-file-invoice" style="font-size:24px; opacity:0.1; display:block; margin-bottom:10px;"></i>
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ÙØªÙˆØ­Ø©
        </div>
    </div>
</div>

<script>
    // --- Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„ÙÙˆØ±ÙŠ (Spot Engine) ---
    let spotSide = 'buy';
    let spotUsdtBalance = 15000.00;
    let spotCoinBalance = 0.00;
    let currentSpotPrice = 98450.00;

    function liveSpotData() {
        currentSpotPrice += (Math.random() - 0.5) * 10;
        const midPrice = document.getElementById('spotMidPrice');
        if(!midPrice) return;
        midPrice.innerText = currentSpotPrice.toFixed(2);
        midPrice.style.color = Math.random() > 0.5 ? 'var(--green)' : 'var(--red)';

        // ØªØ­Ø¯ÙŠØ« Ø¯ÙØªØ± Ø§Ù„Ø£ÙˆØ§Ù…Ø±
        let redH = '', greenH = '';
        for(let i=1; i<=8; i++) {
            redH += `<div style="display:flex; justify-content:space-between;"><span>${(currentSpotPrice + i*2).toFixed(1)}</span><span>${(Math.random()*0.4).toFixed(3)}</span></div>`;
            greenH += `<div style="display:flex; justify-content:space-between;"><span>${(currentSpotPrice - i*2).toFixed(1)}</span><span>${(Math.random()*0.4).toFixed(3)}</span></div>`;
        }
        document.getElementById('spotRedOB').innerHTML = redH;
        document.getElementById('spotGreenOB').innerHTML = greenH;
    }
    setInterval(liveSpotData, 700);

    function setSpotSide(side) {
        spotSide = side;
        const btn = document.getElementById('spotMainBtn');
        const buyBtn = document.getElementById('btnSpotBuy');
        const sellBtn = document.getElementById('btnSpotSell');
        const unit = document.getElementById('availUnit');
        
        if(side === 'buy') {
            buyBtn.style.background = 'var(--green)'; buyBtn.style.color = 'white';
            sellBtn.style.background = 'none'; sellBtn.style.color = 'var(--dim)';
            btn.style.background = 'var(--green)';
            btn.innerText = `Ø´Ø±Ø§Ø¡ ${document.getElementById('qtyUnit').innerText}`;
            document.getElementById('spotAvail').innerText = spotUsdtBalance.toFixed(2);
            unit.innerText = 'USDT';
        } else {
            sellBtn.style.background = 'var(--red)'; sellBtn.style.color = 'white';
            buyBtn.style.background = 'none'; buyBtn.style.color = 'var(--dim)';
            btn.style.background = 'var(--red)';
            btn.innerText = `Ø¨ÙŠØ¹ ${document.getElementById('qtyUnit').innerText}`;
            document.getElementById('spotAvail').innerText = spotCoinBalance.toFixed(4);
            unit.innerText = document.getElementById('qtyUnit').innerText;
        }
    }

    function calcSpotTotal() {
        const qty = document.getElementById('spotQty').value || 0;
        const price = document.getElementById('spotPrice').value || currentSpotPrice;
        document.getElementById('spotTotal').innerText = (qty * price).toFixed(2);
    }

    function setPercent(p) {
        if(spotSide === 'buy') {
            const amountToUse = spotUsdtBalance * (p/100);
            document.getElementById('spotQty').value = (amountToUse / currentSpotPrice).toFixed(5);
        } else {
            document.getElementById('spotQty').value = (spotCoinBalance * (p/100)).toFixed(5);
        }
        calcSpotTotal();
    }

    function executeSpotTrade() {
        const total = parseFloat(document.getElementById('spotTotal').innerText);
        const qty = parseFloat(document.getElementById('spotQty').value);
        
        if(spotSide === 'buy') {
            if(total > spotUsdtBalance || total <= 0) { alert("Ø±ØµÙŠØ¯ USDT ØºÙŠØ± ÙƒØ§ÙÙ!"); return; }
            spotUsdtBalance -= total;
            spotCoinBalance += qty;
            alert(`ØªÙ… Ø´Ø±Ø§Ø¡ ${qty} Ø¨Ù†Ø¬Ø§Ø­!`);
        } else {
            if(qty > spotCoinBalance || qty <= 0) { alert("Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„Ø© ØºÙŠØ± ÙƒØ§ÙÙ!"); return; }
            spotUsdtBalance += total;
            spotCoinBalance -= qty;
            alert(`ØªÙ… Ø¨ÙŠØ¹ ${qty} Ø¨Ù†Ø¬Ø§Ø­!`);
        }
        setSpotSide(spotSide); // Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­
    }

    function toggleSpotMarkets() {
        const list = document.getElementById('spotMarketList');
        list.style.display = list.style.display === 'none' ? 'block' : 'none';
    }

    function selectSpotPair(pair, price) {
        document.getElementById('spotPair').innerText = pair;
        document.getElementById('qtyUnit').innerText = pair.split('/')[0];
        currentSpotPrice = price;
        document.getElementById('spotPrice').value = price;
        setSpotSide(spotSide);
        toggleSpotMarkets();
    }
</script>

    <div id="futures" class="page-content">
    <div style="background: var(--bg); padding: 8px 15px; border-bottom: 1px solid var(--border); display: flex; gap: 15px; align-items: center; position: sticky; top: 0; z-index: 10;">
        <div onclick="toggleMarketList()" style="cursor:pointer; display:flex; align-items:center; gap:5px; background: var(--card); padding: 4px 8px; border-radius: 4px;">
            <strong id="currentPair" style="font-size:14px;">BTCUSDT</strong>
            <i class="fas fa-caret-down" style="color:var(--dim); font-size: 10px;"></i>
        </div>
        <div style="display:flex; flex-direction:column;">
            <span style="color:var(--green); font-weight:bold; font-size:12px;" id="livePriceTop">98,420.50</span>
            <span style="font-size:9px; color:var(--dim)">0.0100% | 04:12:05</span>
        </div>
        <i class="fas fa-chart-line" style="margin-right: auto; color: var(--dim);"></i>
    </div>

    <div id="marketList" style="display:none; position:absolute; top:45px; left:0; width:100%; background:var(--card); z-index:100; border-bottom:1px solid var(--border); box-shadow: 0 5px 15px rgba(0,0,0,0.5);">
        <div class="market-item" onclick="selectPair('BTCUSDT', 98420)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>BTCUSDT</span><span style="color:var(--green)">98,420</span></div>
        <div class="market-item" onclick="selectPair('ETHUSDT', 3240)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>ETHUSDT</span><span style="color:var(--red)">3,240.5</span></div>
        <div class="market-item" onclick="selectPair('SOLUSDT', 126)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>SOLUSDT</span><span style="color:var(--green)">126.8</span></div>
        <div class="market-item" onclick="selectPair('XRPUSDT', 2.50)" style="padding:12px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; cursor:pointer;"><span>XRPUSDT</span><span style="color:var(--green)">2.501</span></div>
    </div>

    <div style="display:flex; padding:10px; gap:10px;">
        <div style="flex:0.7; font-family: mon

